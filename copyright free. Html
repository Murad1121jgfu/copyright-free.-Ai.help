<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CopyrightFree.video | অ্যাডভান্সড ভিডিও এডিটর</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ফন্ট ও বেসিক সেটআপ */
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #e63946;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --gradient: linear-gradient(135deg, #4361ee, #7209b7);
            --gradient-light: linear-gradient(135deg, #4cc9f0, #4361ee);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 15px 50px rgba(0, 0, 0, 0.15);
            --radius: 12px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            margin: 0; 
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            min-height: 100vh;
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto;
            padding: 25px; 
            background-color: #fff; 
            border-radius: 0;
            box-shadow: none;
            position: relative;
            overflow: hidden;
            min-height: 100vh;
        }
        
        /* ডেস্কটপ ভিউ */
        @media (min-width: 769px) {
            body {
                padding: 20px;
            }
            .container {
                margin: 20px auto;
                padding: 30px;
                border-radius: var(--radius);
                box-shadow: var(--shadow-lg);
                min-height: auto;
            }
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient);
        }
        
        h2 { 
            color: var(--primary); 
            text-align: center; 
            padding-bottom: 15px; 
            margin-bottom: 30px; 
            font-size: 1.8em;
            font-weight: 700;
            position: relative;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 150px; 
            height: 4px;
            background: var(--gradient);
            border-radius: 2px;
        }
        
        h3, h4 { 
            color: var(--dark); 
            padding-left: 15px; 
            margin-top: 25px;
            font-weight: 600;
            position: relative;
        }
        
        h3::before, h4::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 20px;
            background: var(--gradient);
            border-radius: 3px;
        }
        
        /* সেকশন স্টাইল */
        .section-box { 
            padding: 20px; 
            margin-bottom: 25px; 
            border: 1px solid var(--gray-light); 
            border-radius: var(--radius); 
            background-color: #fff;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .section-box:hover {
             box-shadow: var(--shadow);
             transform: translateY(-2px);
        }
        
        .section-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--gradient);
            opacity: 0;
            transition: var(--transition);
        }
        
        .section-box:hover::before {
            opacity: 1;
        }
        
        .info-bar { 
            background: var(--gradient-light); 
            padding: 20px; 
            border-radius: var(--radius); 
            margin-bottom: 25px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            font-weight: 600; 
            font-size: 1em; 
            color: white;
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 5px;
        }
        
        .status-free { background: var(--danger); }
        .status-premium { background: var(--success); }
        .status-verified { background: var(--secondary); }
        
        /* ইনপুট ও বাটন স্টাইল */
        .input-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        input[type="email"], input[type="text"], input[type="password"], input[type="file"], textarea, select { 
            display: block; 
            width: 100%; 
            padding: 14px; 
            margin-bottom: 0; 
            box-sizing: border-box; 
            border-radius: var(--radius); 
            border: 1px solid var(--gray-light); 
            font-size: 1em;
            font-family: 'Hind Siliguri', sans-serif;
            transition: var(--transition);
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        textarea { min-height: 100px; resize: vertical; }
        
        .input-icon {
            position: absolute;
            right: 15px;
            top: 15px;
            color: var(--gray);
            pointer-events: none;
        }
        
        button { 
            background: var(--gradient); 
            color: white; 
            padding: 14px 20px; 
            border: none; 
            border-radius: var(--radius); 
            cursor: pointer; 
            margin-top: 10px; 
            width: 100%; 
            font-size: 1em;
            font-weight: 600;
            font-family: 'Hind Siliguri', sans-serif;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        button:hover { 
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(67, 97, 238, 0.4);
        }
        
        /* নির্দিষ্ট বাটন স্টাইল */
        .premium-btn { background: linear-gradient(135deg, #f8961e, #e63946); }
        .premium-btn:hover { box-shadow: 0 7px 15px rgba(248, 150, 30, 0.4); }
        
        .logout-btn {
            background: var(--danger); 
            width: auto !important; 
            margin: 0 !important; 
            padding: 10px 20px !important;
        }
        
        .cert-btn { background: linear-gradient(135deg, #7209b7, #f72585); }
        .cert-btn:hover { box-shadow: 0 7px 15px rgba(114, 9, 183, 0.4); }
        .clean-btn { background: linear-gradient(135deg, #1fa2ff, #12d8fa); }
        .clean-btn:hover { box-shadow: 0 7px 15px rgba(31, 162, 255, 0.4); }

        /* পেমেন্ট সেকশন স্টাইল */
        .payment-options-bar {
            background: linear-gradient(135deg, #fff3e0, #ffecb3);
            padding: 15px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            color: #ff6f00;
            border: 1px dashed #ffb74d;
        }

        /* প্রোফাইল ভেরিফাইড স্টাইল */
        .verified-badge {
            display: inline-flex;
            align-items: center;
            background: var(--success);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            margin-left: 5px;
        }
        
        .premium-features, .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .feature-card {
            background: var(--light);
            padding: 15px;
            border-radius: var(--radius);
            text-align: center;
            transition: var(--transition);
            border: 1px solid var(--gray-light);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon { font-size: 2em; color: var(--primary); margin-bottom: 10px; }

        /* প্রোগ্রেস বার */
        .progress-container { margin: 20px 0; }
        .progress-bar { height: 10px; background: var(--gray-light); border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--gradient); border-radius: 5px; width: 0%; transition: width 1s ease; }
        
        /* ট্যাব সিস্টেম */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab {
            padding: 12px 18px;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: var(--transition);
            position: relative;
            flex-shrink: 0;
            white-space: nowrap;
        }
        
        .tab.active { color: var(--primary); }
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
            border-radius: 3px 3px 0 0;
        }
        
        .pro-badge {
            background: var(--accent);
            color: white;
            font-size: 0.6em;
            padding: 2px 5px;
            border-radius: 4px;
            position: absolute;
            top: 5px;
            right: 5px;
            font-weight: 700;
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* নতুন এডিটিং টুলস স্টাইল */
        .editor-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .control-group {
            background: var(--light);
            padding: 15px;
            border-radius: var(--radius);
            border: 1px solid var(--gray-light);
        }
        
        .control-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: var(--gray-light);
            outline: none;
        }
        
        .range-value {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            color: var(--primary);
        }
        
        .video-preview-container {
            position: relative;
            margin: 20px 0;
            background: #000;
            border-radius: var(--radius);
            overflow: hidden;
            max-height: 400px;
        }
        
        .preview-controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 25px;
        }
        
        .preview-controls button {
            width: auto;
            margin: 0;
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        /* থাম্বনেল জেনারেটর স্টাইল */
        .thumbnail-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .thumbnail-item {
            position: relative;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .thumbnail-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .thumbnail-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .thumbnail-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            font-size: 0.8em;
        }
        
        .thumbnail-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
        }
        
        .thumbnail-actions button {
            width: auto;
            margin: 0;
            padding: 5px 10px;
            font-size: 0.8em;
            background: rgba(255,255,255,0.9);
            color: var(--dark);
        }
   /* গ্যালারি স্টাইল */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .gallery-item {
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            background: white;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .gallery-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        
        .gallery-info {
            padding: 15px;
        }
        
        .gallery-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .gallery-meta {
            font-size: 0.8em;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .gallery-actions {
            display: flex;
            gap: 10px;
        }
        
        .gallery-actions button {
            width: auto;
            margin: 0;
            padding: 8px 15px;
            font-size: 0.8em;
        }

        /* অন্যান্য */
        .hidden { display: none !important; }
        
        #uploadedVideo, #wmrVideoOutput, #brandingVideoOutput, #editorVideoOutput {
            width: 100%;
            max-height: 400px;
            margin-top: 15px;
            border-radius: var(--radius);
            background-color: #000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .result-detail { background-color: var(--light); padding: 15px; border-radius: var(--radius); margin-top: 15px; border-left: 5px solid var(--primary); }
        
        .report-section { margin-top: 20px; padding: 15px; background-color: #ffeaea; border-radius: var(--radius); border: 1px solid var(--danger); }
        .report-section.clean { background-color: #e6ffed; border: 1px solid #43a047; }
        
        .library-card {
            background-color: #fff;
            padding: 15px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 15px;
            border-left: 5px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .library-card-badge { background: var(--success); color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8em; font-weight: 600; }
        .music-card { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--gray-light); flex-wrap: wrap; gap: 10px; }

        /* মিডিয়া কোয়েরি */
        @media (max-width: 768px) {
            h2 { font-size: 1.6em; }
            .section-box { padding: 15px; }
            
            .info-bar { 
                flex-direction: column; 
                align-items: flex-start; 
                gap: 15px;
            }
            
            .logout-btn { 
                align-self: flex-end;
                margin-top: 0 !important;
            }
            
            .premium-features, .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .library-card {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .editor-controls {
                grid-template-columns: 1fr;
            }
            
            .thumbnail-container, .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .container { padding: 10px; }
            h2 { font-size: 1.4em; }
            .tab { padding: 10px 12px; font-size: 0.9em; }
            
            .music-card {
                flex-direction: column;
                align-items: flex-start;
            }
            .music-card button {
                margin-top: 5px !important;
            }
            
            .thumbnail-container, .gallery-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h2><i class="fas fa-video"></i> CopyrightFree.video | অ্যাডভান্সড ভিডিও এডিটর</h2>
    <p style="text-align: center; color: var(--gray); margin-top: -20px; margin-bottom: 20px;">AI-পাওয়ারড ভিডিও এডিটিং ও থাম্বনেল জেনারেটর</p>

    <div class="section-box auth-section" id="authSection">
        <h3>সাইন আপ / লগইন</h3>
        <div class="input-group">
            <input type="email" id="authEmail" placeholder="ইমেল লিখুন (যেমন: user@example.com)" required>
            <span class="input-icon"><i class="fas fa-envelope"></i></span>
        </div>
        <button onclick="handleAuth('signup')"><i class="fas fa-user-plus"></i> সাইন আপ</button>
        <button onclick="handleAuth('login')"><i class="fas fa-sign-in-alt"></i> লগইন</button>
        <p id="authMessage" style="color: red; margin-top: 10px; text-align: center;"></p>
    </div>

    <div class="dashboard hidden" id="dashboard">
        <div class="info-bar">
            <div class="user-profile">
                <div class="avatar"><i class="fas fa-user"></i></div>
                <div>
                    <div>ইউজার: <span id="currentEmail"></span> <span id="verifiedBadge" class="status-badge status-verified hidden"><i class="fas fa-check-double"></i> ভেরিফাইড</span></div>
                    <div>পয়েন্ট: <span id="currentPoints">0</span></div>
                </div>
            </div>
            <div>
                <span>স্ট্যাটাস: <span id="premiumStatus" class="status-badge status-free">ফ্রি ইউজার</span></span>
            </div>
            <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> লগআউট</button>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('upload')"><i class="fas fa-upload"></i> আপলোড</div>
            <div class="tab" onclick="switchTab('editor')"><i class="fas fa-edit"></i> ভিডিও এডিটর</div>
            <div class="tab" onclick="switchTab('thumbnail')"><i class="fas fa-image"></i> থাম্বনেল জেনারেটর</div>
            <div class="tab" onclick="switchTab('gallery')"><i class="fas fa-photo-video"></i> আমার গ্যালারি</div>
            <div class="tab" onclick="switchTab('rules')"><i class="fas fa-scroll"></i> নিয়মাবলী</div>
            <div class="tab" onclick="switchTab('premium')"><i class="fas fa-crown"></i> প্রিমিয়াম</div>
            <div class="tab" onclick="switchTab('profile')"><i class="fas fa-user-circle"></i> প্রোফাইল</div>
        </div>

        <!-- আপলোড ট্যাব -->
        <div class="tab-content active" id="uploadTab">
            <div class="section-box upload-section">
                <h4><i class="fas fa-cloud-upload-alt"></i> ভিডিও আপলোড ও কপিরাইট স্ক্যান</h4>
                <div class="progress-container">
                    <div class="progress-text"><span>আপনার দৈনিক পয়েন্ট</span><span id="pointsProgress">0/20</span></div>
                    <div class="progress-bar"><div class="progress-fill" id="pointsFill"></div></div>
                </div>
                <label for="videoFile" style="display: block; margin-bottom: 10px; font-weight: 600;">আপনার ভিডিও ফাইলটি নির্বাচন করুন (MP4, MOV, AVI):</label>
                <div class="input-group"><input type="file" id="videoFile" accept="video/*"></div>
                <button onclick="handleFileUpload()"><i class="fas fa-search"></i> আপলোড ও স্ক্যান শুরু করুন</button>
                <p id="scanStatus" style="margin-top: 15px; font-weight: bold; text-align: center; padding: 10px; border-radius: var(--radius);">ফাইল আপলোড করার জন্য অপেক্ষা করছে...</p>
            </div>

            <div class="section-box result-section hidden" id="resultContainer">
                <h3><i class="fas fa-video"></i> স্ক্যান রেজাল্ট ও আউটপুট</h3>
                <p>ভিডিওর দৈর্ঘ্য: <span id="videoDuration">0.00</span> সেকেন্ড।</p>
                <video id="uploadedVideo" controls></video>
                
                <div id="copyrightReport" class="report-section hidden">
                    <h4 style="margin-top: 0;"><i class="fas fa-exclamation-triangle"></i> কপিরাইট রিপোর্ট: <span id="reportStatus">Flagged</span></h4>
                    <p id="reportDetails">অডিও এবং ভিজ্যুয়াল কন্টেন্টে **আংশিক মিল** পাওয়া গেছে।</p>
                    <button class="clean-btn" onclick="aiAutoClean()"><i class="fas fa-magic"></i> AI অটো কপিরাইট ক্লিনার ব্যবহার করুন</button>
                    <p id="cleanStatus" style="margin-top: 10px; text-align: center; font-weight: 600; color: var(--primary);"></p>
                </div>

                <div id="cleanOutput" class="result-detail hidden">
                    <button id="downloadButton" onclick="downloadVideo()"><i class="fas fa-download"></i> ভিডিওটি ডাউনলোড করুন</button>
                    <button id="certificateButton" class="cert-btn hidden" onclick="generateCertificate()"><i class="fas fa-certificate"></i> লাইসেন্স সার্টিফিকেট ডাউনলোড করুন</button>
                    <div class="checkbox-container hidden" id="publicCheckboxContainer">
                        <input type="checkbox" id="addToPublicLibrary">
                        <label for="addToPublicLibrary">আমি এই কপিরাইট ফ্রি ভিডিওটি পাবলিক লাইব্রেরিতে যোগ করতে রাজি।</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- নতুন ভিডিও এডিটর ট্যাব -->
        <div class="tab-content" id="editorTab">
            <div class="section-box">
                <h4><i class="fas fa-edit"></i> অ্যাডভান্সড ভিডিও এডিটর</h4>
                <p style="margin-bottom: 20px;">আপনার ভিডিও এডিট ও অপ্টিমাইজ করুন এক ক্লিকে!</p>
                
                <div class="input-group">
                    <input type="file" id="editorVideoFile" accept="video/*">
                </div>
                
                <div class="video-preview-container">
                    <video id="editorVideoOutput" controls></video>
                    <div class="preview-controls">
                        <button onclick="playPauseVideo()"><i class="fas fa-play"></i></button>
                        <button onclick="resetVideo()"><i class="fas fa-redo"></i></button>
                    </div>
                </div>

                <div class="editor-controls">
                    <div class="control-group">
                        <label class="control-label">ভলিউম কন্ট্রোল</label>
                        <div class="range-container">
                            <input type="range" id="volumeControl" min="0" max="100" value="100">
                            <span class="range-value" id="volumeValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">প্লেব্যাক স্পিড</label>
                        <div class="range-container">
                            <input type="range" id="speedControl" min="25" max="200" value="100">
                            <span class="range-value" id="speedValue">1.0x</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ব্রাইটনেস</label>
                        <div class="range-container">
                            <input type="range" id="brightnessControl" min="50" max="150" value="100">
                            <span class="range-value" id="brightnessValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">কন্ট্রাস্ট</label>
                        <div class="range-container">
                            <input type="range" id="contrastControl" min="50" max="150" value="100">
                            <span class="range-value" id="contrastValue">100%</span>
                        </div>
                    </div>
                </div>

                <div class="editor-controls">
                    <div class="control-group">
                        <label class="control-label">ফিল্টার প্রিসেট</label>
                        <select id="filterSelect" onchange="applyFilter()">
                            <option value="none">কোন ফিল্টার নেই</option>
                            <option value="grayscale">ব্ল্যাক এন্ড হোয়াইট</option>
                            <option value="sepia">সেপিয়া</option>
                            <option value="vintage">ভিনটেজ</option>
                            <option value="cool">কুল টোন</option>
                            <option value="warm">ওয়ার্ম টোন</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ওয়াটারমার্ক টেক্সট</label>
                        <input type="text" id="watermarkText" placeholder="আপনার ব্র্যান্ড নাম" oninput="updateWatermark()">
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ট্রিম ভিডিও</label>
                        <div class="range-container">
                            <input type="range" id="trimStart" min="0" max="100" value="0">
                            <span class="range-value" id="trimStartValue">0%</span>
                        </div>
                        <div class="range-container">
                            <input type="range" id="trimEnd" min="0" max="100" value="100">
                            <span class="range-value" id="trimEndValue">100%</span>
                        </div>
                    </div>
                </div>

                <!-- অ্যাডভান্সড এডিটিং ফিচার -->
                <div class="section-box" style="margin-top: 20px;">
                    <h4 style="margin-top: 0;"><i class="fas fa-magic"></i> অ্যাডভান্সড এডিটিং ফিচার</h4>
                    
                    <div class="editor-controls">
                        <div class="control-group">
                            <label class="control-label">AI ব্যাকগ্রাউন্ড রিমুভাল</label>
                            <button onclick="simulateAIBackgroundRemoval()" style="width: auto; margin: 0;"><i class="fas fa-user-secret"></i> ব্যাকগ্রাউন্ড রিমুভ করুন</button>
                        </div>
                        
                        <div class="control-group">
                            <label class="control-label">ফেস এনহ্যান্সমেন্ট</label>
                            <button onclick="simulateFaceEnhancement()" style="width: auto; margin: 0;"><i class="fas fa-smile"></i> ফেস এনহ্যান্স করুন</button>
                        </div>
                        
                        <div class="control-group">
                            <label class="control-label">অটো সাবটাইটেল জেনারেশন</label>
                            <button onclick="simulateAutoSubtitle()" style="width: auto; margin: 0;"><i class="fas fa-closed-captioning"></i> সাবটাইটেল জেনারেট করুন</button>
                        </div>
                    </div>
                    
                    <div class="editor-controls">
                        <div class="control-group">
                            <label class="control-label">ভিডিও স্ট্যাবিলাইজেশন</label>
                            <button onclick="simulateStabilization()" style="width: auto; margin: 0;"><i class="fas fa-camera"></i> ভিডিও স্ট্যাবিলাইজ করুন</button>
                        </div>
                        
                        <div class="control-group">
                            <label class="control-label">নয়েজ রিডাকশন</label>
                            <button onclick="simulateNoiseReduction()" style="width: auto; margin: 0;"><i class="fas fa-volume-mute"></i> নয়েজ রিমুভ করুন</button>
                        </div>
                        
                        <div class="control-group">
                            <label class="control-label">স্মার্ট ক্রপিং</label>
                            <button onclick="simulateSmartCropping()" style="width: auto; margin: 0;"><i class="fas fa-crop"></i> অটো ক্রপ করুন</button>
                        </div>
                    </div>
                </div>

                <button onclick="applyAllEdits()"><i class="fas fa-magic"></i> সব এডিট প্রয়োগ করুন</button>
                <button onclick="downloadEditedVideo()" class="premium-btn"><i class="fas fa-download"></i> এডিটেড ভিডিও ডাউনলোড করুন</button>
                <button onclick="saveToGallery('video')" class="cert-btn"><i class="fas fa-save"></i> গ্যালারিতে সেভ করুন</button>
                <p id="editorStatus" style="margin-top: 10px; text-align: center; color: var(--primary);"></p>
            </div>
        </div>

        <!-- থাম্বনেল জেনারেটর ট্যাব -->
        <div class="tab-content" id="thumbnailTab">
            <div class="section-box">
                <h4><i class="fas fa-image"></i> AI থাম্বনেল জেনারেটর</h4>
                <p style="margin-bottom: 20px;">আপনার ভিডিওর জন্য আকর্ষণীয় থাম্বনেল তৈরি করুন AI-এর সাহায্যে!</p>
                
                <div class="input-group">
                    <input type="file" id="thumbnailVideoFile" accept="video/*">
                </div>
                
                <div class="input-group">
                    <textarea id="thumbnailDescription" placeholder="থাম্বনেলের জন্য ডিসক্রিপশন লিখুন (যেমন: 'সূর্যাস্তের দৃশ্য, সমুদ্র তীর, শান্ত পরিবেশ')"></textarea>
                </div>
                
                <div class="editor-controls">
                    <div class="control-group">
                        <label class="control-label">থাম্বনেল স্টাইল</label>
                        <select id="thumbnailStyle">
                            <option value="modern">মডার্ন</option>
                            <option value="vintage">ভিনটেজ</option>
                            <option value="minimal">মিনিমাল</option>
                            <option value="bold">বোল্ড ও কালারফুল</option>
                            <option value="dark">ডার্ক থিম</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">টেক্সট ওভারলে</label>
                        <input type="text" id="thumbnailText" placeholder="থাম্বনেল টেক্সট (ঐচ্ছিক)">
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ফন্ট সাইজ</label>
                        <div class="range-container">
                            <input type="range" id="fontSizeControl" min="20" max="60" value="30">
                            <span class="range-value" id="fontSizeValue">30px</span>
                        </div>
                    </div>
                </div>
                
                <button onclick="generateThumbnails()"><i class="fas fa-magic"></i> থাম্বনেল জেনারেট করুন</button>
                
                <div id="thumbnailResults" class="thumbnail-container hidden">
                    <!-- থাম্বনেলগুলো এখানে জেনারেট হবে -->
                </div>
                
                <p id="thumbnailStatus" style="margin-top: 10px; text-align: center; color: var(--primary);"></p>
            </div>
        </div>

        <!-- গ্যালারি ট্যাব -->
        <div class="tab-content" id="galleryTab">
            <div class="section-box">
                <h4><i class="fas fa-photo-video"></i> আমার গ্যালারি</h4>
                <p style="margin-bottom: 20px;">আপনার তৈরি করা ভিডিও, থাম্বনেল এবং সার্টিফিকেটগুলো এখানে সংরক্ষিত আছে।</p>
                
                <div class="tabs" style="margin-bottom: 20px;">
                    <div class="tab active" onclick="switchGalleryTab('videos')">ভিডিও</div>
                    <div class="tab" onclick="switchGalleryTab('thumbnails')">থাম্বনেল</div>
                    <div class="tab" onclick="switchGalleryTab('certificates')">সার্টিফিকেট</div>
                </div>
                
                <div id="videosGallery" class="gallery-grid">
                    <!-- ভিডিও গ্যালারি কন্টেন্ট -->
                </div>
                
                <div id="thumbnailsGallery" class="gallery-grid hidden">
                    <!-- থাম্বনেল গ্যালারি কন্টেন্ট -->
                </div>
                
                <div id="certificatesGallery" class="gallery-grid hidden">
                    <!-- সার্টিফিকেট গ্যালারি কন্টেন্ট -->
                </div>
                
                <div id="emptyGalleryMessage" class="result-detail" style="text-align: center;">
                    <p>😥 আপনার গ্যালারিতে এখনও কোনো আইটেম নেই।</p>
                    <p>ভিডিও এডিট করুন বা থাম্বনেল জেনারেট করুন এবং সেগুলো গ্যালারিতে সেভ করুন।</p>
                </div>
            </div>
        </div>

        <!-- বাকি ট্যাবগুলো একই রাখা হয়েছে -->
        <div class="tab-content" id="rulesTab">
            <div class="section-box rules-section">
                <h4><i class="fas fa-scroll"></i> প্ল্যাটফর্ম নিয়মাবলী ও শর্ত</h4>
                <p style="color: var(--primary); font-weight: bold; margin-bottom: 15px;">ভিডিও আপলোড করার আগে নিশ্চিত করুন:</p>
                <ol class="rules-list">
                    <li><strong>দৈর্ঘ্য ও পয়েন্ট (ফ্রি ইউজার):</strong> ফ্রি অ্যাকাউন্টে ভিডিওর দৈর্ঘ্য সর্বোচ্চ **১০ সেকেন্ড** হতে পারে। প্রতি ১০ সেকেন্ড প্রসেস করতে **২০ পয়েন্ট** খরচ হয়।</li>
                    <li><strong>দৈনিক পয়েন্ট:</strong> ফ্রি অ্যাকাউন্টে প্রতিদিন **২০ পয়েন্ট** পাওয়া যায়, তবে শুধুমাত্র যদি আপনার বর্তমান পয়েন্ট **শূন্য (০)** থাকে। পয়েন্ট জমা হবে না।</li>
                    <li><strong>প্রিমিয়াম সুবিধা:</strong> প্রিমিয়াম ইউজাররা **আনলিমিটেড দৈর্ঘ্যের ভিডিও** আপলোড করতে পারবেন এবং **লাইসেন্স সার্টিফিকেট** ডাউনলোড করতে পারবেন।</li>
                    <li><strong>AI Cleaner:</strong> AI অটো ক্লিনার ব্যবহার করলে ভিডিওর কিছু অংশে **হালকা পরিবর্তন** আসতে পারে (যেমন- সাউন্ড ফিল্টার, ব্যাকগ্রাউন্ড ব্লার)।</li>
                    <li><strong>নিজস্ব কনটেন্ট:</strong> আপলোড করা কনটেন্ট যেন অন্য কোনো কপিরাইটযুক্ত প্ল্যাটফর্ম থেকে সরাসরি নেওয়া না হয়।</li>
                </ol>
                <div class="checkbox-container">
                    <input type="checkbox" id="agreeRules">
                    <label for="agreeRules">আমি এই <strong>শর্তাবলী সম্পূর্ণরূপে মেনে নিচ্ছি</strong>।</label>
                </div>
            </div>
        </div>

        <div class="tab-content" id="premiumTab">
            <div class="section-box premium-section">
                <h3><i class="fas fa-crown"></i> প্রিমিয়াম ফিচার</h3>
                <p id="premiumMessage" style="font-size: 1.1em; margin-bottom: 20px;">প্রিমিয়াম সাবস্ক্রিপশনের মাধ্যমে আনলিমিটেড ভিডিও কপিরাইট ফ্রি করুন।</p>
                
                <div class="premium-features">
                    <div class="feature-card"><div class="feature-icon"><i class="fas fa-infinity"></i></div><h4>আনলিমিটেড ভিডিও</h4><p>যেকোনো দৈর্ঘ্যের ভিডিও ফ্রি করুন</p></div>
                    <div class="feature-card"><div class="feature-icon"><i class="fas fa-certificate"></i></div><h4>লাইসেন্স সার্টিফিকেট</h4><p>কপিরাইট ফ্রি সার্টিফিকেট ডাউনলোড করুন</p></div>
                    <div class="feature-card"><div class="feature-icon"><i class="fas fa-bolt"></i></div><h4>প্রায়োরিটি প্রসেসিং</h4><p>দ্রুত স্ক্যানিং ও প্রসেসিং</p></div>
                    <div class="feature-card"><div class="feature-icon"><i class="fas fa-toolbox"></i></div><h4>প্রো টুলস অ্যাক্সেস</h4><p>ওয়াটারমার্ক রিমুভারসহ সমস্ত টুলস</p></div>
                </div>
                
                <button id="buyPremiumBtn" class="premium-btn" onclick="showPaymentVerification('monthly')"><i class="fas fa-shopping-cart"></i> মাসিক প্রিমিয়াম (৳300)</button>
                <button id="buyPremiumBtnYearly" class="premium-btn" onclick="showPaymentVerification('yearly')"><i class="fas fa-shopping-cart"></i> বার্ষিক প্রিমিয়াম (৳3000)</button>
            </div>

            <div class="section-box verification-form hidden" id="paymentVerificationForm">
                <h4><i class="fas fa-money-check-alt"></i> পেমেন্ট যাচাইকরণ</h4>
                
                <div class="payment-options-bar">
                    <i class="fas fa-wallet payment-icon"></i>
                    পেমেন্ট করুন: 
                    <span style="color: #d13669;"><i class="fas fa-mobile-alt"></i> বিকাশ</span> | 
                    <span style="color: #e54c00;"><i class="fas fa-money-bill-wave"></i> নগদ</span> | 
                    <span style="color: #922c88;"><i class="fas fa-rocket"></i> রকেট</span>
                </div>
                
                <p style="font-weight: bold; margin-bottom: 5px;">অনুগ্রহ করে এই <strong>পার্সোনাল নাম্বারে</strong> পেমেন্ট সম্পন্ন করুন:</p>
                <p style="color: var(--danger); font-size: 1.2em; font-weight: bold; text-align: center; border: 1px solid var(--danger); padding: 10px; border-radius: var(--radius); background: #ffeaea;">
                    <i class="fas fa-phone"></i> +880 1795-382757
                </p>
                <p id="paymentAmount" style="margin-top: 15px; font-style: italic; text-align: center;"></p>
                
                <div class="input-group">
                    <input type="text" id="transactionId" placeholder="আপনার ট্রানজ্যাকশন আইডি (TrxID) লিখুন" required>
                    <span class="input-icon"><i class="fas fa-receipt"></i></span>
                </div>
                <div class="input-group">
                    <input type="password" id="secretPin" placeholder="গোপন পিন কোড লিখুন" required>
                    <span class="input-icon"><i class="fas fa-key"></i></span>
                </div>
                
                <p style="font-size: 0.9em; color: var(--danger); margin-bottom: 15px; font-weight: bold; text-align: center;">
                    <i class="fas fa-exclamation-triangle"></i> (গুরুত্বপূর্ণ: গোপন পিন কোডটি পেতে পেমেন্টের পর অবশ্যই সাপোর্ট টিমের সাথে যোগাযোগ করুন)
                </p>
                <a href="https://t.me/copyrighesupportteam" target="_blank" class="support-link" style="color: #0088cc; text-decoration: none; font-weight: 600; display: block; text-align: center; margin-bottom: 15px;">
                    <i class="fab fa-telegram"></i> @copyrighesupportteam (Telegram) <i class="fas fa-external-link-alt" style="font-size: 0.8em; margin-left: 5px;"></i>
                </a>
                 <button onclick="verifyPayment()"><i class="fas fa-check-circle"></i> পেমেন্ট যাচাই করুন</button>
                <p id="verificationMessage" style="color: red; margin-top: 15px; text-align: center;"></p>
            </div>
        </div>
        
        <div class="tab-content" id="profileTab">
            <div class="section-box">
                <h4><i class="fas fa-user-circle"></i> প্রোফাইল তথ্য ও অ্যানালিটিক্স</h4>
                <div class="user-profile" style="margin: 20px 0;">
                    <div class="avatar" style="width: 80px; height: 80px; font-size: 2em;">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <h3 id="profileEmail" style="margin-top: 0;"></h3>
                        <p style="margin-top: 5px;"><span id="profileStatus" class="status-badge status-free">ফ্রি ইউজার</span> <span id="profileVerifiedBadge" class="status-badge status-verified hidden">ভেরিফাইড ক্রিয়েটর</span></p>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-text">
                        <span>আপনার দৈনিক পয়েন্ট ব্যবহার</span>
                        <span id="profilePointsProgress">0/20</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="profilePointsFill"></div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h4><i class="fas fa-chart-line"></i> অ্যাকাউন্ট অ্যানালিটিক্স</h4>
                    <div class="analytics-grid">
                        <div class="feature-card">
                            <div class="feature-icon" style="color: var(--secondary);"><i class="fas fa-upload"></i></div>
                            <h4>মোট আপলোড</h4>
                            <p id="processedVideos">0</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon" style="color: #43a047;"><i class="fas fa-check-circle"></i></div>
                            <h4>ক্লিন ভিডিও</h4>
                            <p id="cleanVideos">0</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-certificate"></i></div>
                            <h4>ডাউনলোড সার্টিফিকেট</h4>
                            <p id="certificatesCount">0</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon" style="color: var(--warning);"><i class="fas fa-flag"></i></div>
                            <h4>AI ক্লিনার ব্যবহৃত</h4>
                            <p id="aiCleanedCount">0</p>
                        </div>
                    </div>
                </div>

                <div class="section-box" style="margin-top: 25px;">
                    <h4 style="margin-top: 0;"><i class="fas fa-shield-alt"></i> ক্রিয়েটর ভেরিফিকেশন</h4>
                    <p id="verificationMessageProfile">
                        আপনার প্রোফাইল বর্তমানে **ভেরিফাইড** নয়। নিয়মিত উচ্চ মানের কপিরাইট ফ্রি ভিডিও আপলোড করলে এবং প্রিমিয়াম ইউজার হলে স্বয়ংক্রিয়ভাবে ভেরিফাইড ব্যাজ পাবেন।
                    </p>
                    <button onclick="requestVerification()" id="verificationRequestBtn" class="cert-btn hidden" style="width: auto;"><i class="fas fa-user-check"></i> ভেরিফিকেশন এর জন্য আবেদন করুন</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="notification" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 15px 25px; border-radius: var(--radius); box-shadow: var(--shadow-lg); z-index: 1000; opacity: 0; transition: all 0.4s ease; font-weight: 600;"></div>
<canvas id="certificateCanvas" style="display: none;"></canvas>
<canvas id="thumbnailCanvas" style="display: none;"></canvas>

<script>
    // --- গ্লোবাল ভেরিয়েবল ও কনফিগারেশন ---
    let videoURL = null;
    let videoFileName = 'downloaded_video.mp4'; 
    let currentPaymentType = ''; 
    let currentVideoDuration = 0;
    const COST_PER_10_SEC = 20;
    const DAILY_FREE_POINTS = 20; 
    
    // লোকাল স্টোরেজ কী
    const LS_KEY_USERS = 'cfvUsers';
    const LS_KEY_LOGGED_IN_EMAIL = 'cfvLoggedInUserEmail';
    const LS_KEY_LAST_RESET = 'cfvLastResetDate';
    const LS_KEY_USED_PINS = 'cfvUsedPins'; 
    const LS_KEY_USER_STATS = 'cfvUserStats';
    const LS_KEY_GALLERY = 'cfvGallery';
    
    // --- ইউটিলিটি ফাংশন (লোকাল স্টোরেজ) ---
    function getUsers() { return JSON.parse(localStorage.getItem(LS_KEY_USERS) || '{}'); }
    function saveUsers(users) { localStorage.setItem(LS_KEY_USERS, JSON.stringify(users)); }
    function getLoggedInEmail() { return localStorage.getItem(LS_KEY_LOGGED_IN_EMAIL); }
    function getPoints(email) { const users = getUsers(); return users[email] ? users[email].points : 0; }
    function savePoints(email, points) { const users = getUsers(); if (users[email]) { users[email].points = points; saveUsers(users); } }
    function isPremiumUser(email) { const users = getUsers(); return users[email] ? users[email].isPremium : false; }
    function setPremium(email, status) { const users = getUsers(); if (users[email]) { users[email].isPremium = status; saveUsers(users); } }
    function isVerifiedCreator(email) { const users = getUsers(); return users[email] ? users[email].isVerified : false; }
    function setVerified(email, status) { const users = getUsers(); if (users[email]) { users[email].isVerified = status; saveUsers(users); } }
    
    function getUsedPins() { return JSON.parse(localStorage.getItem(LS_KEY_USED_PINS) || '[]'); }
    function addUsedPin(pin) {
        const usedPins = getUsedPins();
        if (!usedPins.includes(pin)) {
            usedPins.push(pin);
            localStorage.setItem(LS_KEY_USED_PINS, JSON.stringify(usedPins));
        }
    }
    
    function getUserStats(email) {
        const stats = JSON.parse(localStorage.getItem(LS_KEY_USER_STATS) || '{}');
        if (!stats[email]) {
            stats[email] = { processedVideos: 0, cleanVideos: 0, certificates: 0, aiCleanedCount: 0 };
            localStorage.setItem(LS_KEY_USER_STATS, JSON.stringify(stats));
        }
        return stats[email];
    }
    
    function updateUserStats(email, field, value) {
        const stats = JSON.parse(localStorage.getItem(LS_KEY_USER_STATS) || '{}');
        if (stats[email]) {
            stats[email][field] = value;
            localStorage.setItem(LS_KEY_USER_STATS, JSON.stringify(stats));
            checkVerificationEligibility(email);
        }
    }

    function getGallery() { 
        const email = getLoggedInEmail();
        const gallery = JSON.parse(localStorage.getItem(LS_KEY_GALLERY) || '{}');
        return gallery[email] || { videos: [], thumbnails: [], certificates: [] };
    }
    
    function saveToGallery(type, item) {
        const email = getLoggedInEmail();
        if (!email) return;
        
        const gallery = JSON.parse(localStorage.getItem(LS_KEY_GALLERY) || '{}');
        if (!gallery[email]) {
            gallery[email] = { videos: [], thumbnails: [], certificates: [] };
        }
        
        item.id = Date.now().toString();
        item.createdAt = new Date().toISOString();
        
        if (type === 'video') {
            gallery[email].videos.push(item);
        } else if (type === 'thumbnail') {
            gallery[email].thumbnails.push(item);
        } else if (type === 'certificate') {
            gallery[email].certificates.push(item);
        }
        
        localStorage.setItem(LS_KEY_GALLERY, JSON.stringify(gallery));
        renderGallery();
        showNotification(`${type === 'video' ? 'ভিডিও' : type === 'thumbnail' ? 'থাম্বনেল' : 'সার্টিফিকেট'} গ্যালারিতে সেভ হয়েছে!`, 'success');
    }
    
    // --- নোটিফিকেশন সিস্টেম ---
    function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        if (!notification) return;
        
        notification.textContent = message;
        if (type === 'error') notification.style.background = 'var(--danger)';
        else if (type === 'warning') notification.style.background = 'var(--warning)';
        else if (type === 'secondary') notification.style.background = 'var(--secondary)';
        else notification.style.background = '#333';

        notification.style.opacity = '1';
        notification.style.bottom = '20px';
        
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.bottom = '-50px';
        }, 3000);
    }
    
    // --- ট্যাব সিস্টেম ---
    function switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        
        document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
        document.getElementById(`${tabName}Tab`).classList.add('active');
        
        if (tabName === 'gallery') {
            renderGallery();
        }
    }
    
    function switchGalleryTab(tabName) {
        document.querySelectorAll('#galleryTab .tab').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('#galleryTab .gallery-grid').forEach(content => {
            content.classList.add('hidden');
        });
        
        document.querySelector(`#galleryTab .tab[onclick="switchGalleryTab('${tabName}')"]`).classList.add('active');
        document.getElementById(`${tabName}Gallery`).classList.remove('hidden');
    }

    // --- অথেনটিকেশন লজিক ---
    function handleAuth(type) {
        const email = document.getElementById('authEmail').value.trim();
        const authMessage = document.getElementById('authMessage');
        let users = getUsers();
        authMessage.innerText = '';

        if (!email || !email.includes('@')) { 
            authMessage.innerText = '⚠️ সঠিক ইমেল আইডি লিখুন।'; 
            return; 
        }

        if (type === 'signup') {
            if (users[email]) { 
                authMessage.innerText = '⚠️ এই ইমেলটি ইতিমধ্যেই নিবন্ধিত। লগইন করুন।'; 
            } else {
                users[email] = { points: DAILY_FREE_POINTS, isPremium: false, isVerified: false };
                saveUsers(users);
                localStorage.setItem(LS_KEY_LOGGED_IN_EMAIL, email);
                showNotification('✅ সাইন আপ সফল! আপনি এখন লগইন করেছেন এবং ২০ পয়েন্ট পেয়েছেন।');
                checkAuthStatus();
            }
        } else if (type === 'login') {
            if (users[email]) {
                localStorage.setItem(LS_KEY_LOGGED_IN_EMAIL, email);
                showNotification('✅ লগইন সফল!');
                checkAuthStatus();
            } else { 
                authMessage.innerText = '⚠️ এই ইমেলটি নিবন্ধিত নয়। সাইন আপ করুন।'; 
            }
        }
    }

    function logout() {
        localStorage.removeItem(LS_KEY_LOGGED_IN_EMAIL);
        showNotification('সফলভাবে লগআউট করা হয়েছে।');
        checkAuthStatus();
    }

    function checkAuthStatus() {
        const loggedInEmail = getLoggedInEmail();
        const authSection = document.getElementById('authSection');
        const dashboard = document.getElementById('dashboard');
        
        if (loggedInEmail) {
            authSection.classList.add('hidden');
            dashboard.classList.remove('hidden');
            resetDailyPoints(loggedInEmail);
            updateUI(loggedInEmail);
            initializeEditorControls();
            renderGallery();
        } else {
            authSection.classList.remove('hidden');
            dashboard.classList.add('hidden');
        }
    }

    // --- পয়েন্ট, প্রিমিয়াম ও UI লজিক ---
    function resetDailyPoints(email) {
        const today = new Date().toDateString();
        const lastReset = localStorage.getItem(LS_KEY_LAST_RESET);
        
        if (lastReset !== today && !isPremiumUser(email)) {
            let points = getPoints(email);
            
            if (points === 0) {
                 savePoints(email, DAILY_FREE_POINTS);
                 showNotification(`🥳 আজকের জন্য নতুন ${DAILY_FREE_POINTS} পয়েন্ট পেয়েছেন!`);
            }
            
            localStorage.setItem(LS_KEY_LAST_RESET, today);
        }
    }

    function updateUI(email) {
        const loggedInEmail = email || getLoggedInEmail();
        if (!loggedInEmail) return;

        const points = getPoints(loggedInEmail);
        const isPremium = isPremiumUser(loggedInEmail);
        const isVerified = isVerifiedCreator(loggedInEmail);
        const userStats = getUserStats(loggedInEmail);
        
        // ড্যাশবোর্ড আপডেট
        document.getElementById('currentEmail').innerText = loggedInEmail;
        document.getElementById('currentPoints').innerText = points;
        document.getElementById('profileEmail').innerText = loggedInEmail;
        
        // অ্যানালিটিক্স আপডেট
        document.getElementById('processedVideos').innerText = userStats.processedVideos;
        document.getElementById('cleanVideos').innerText = userStats.cleanVideos;
        document.getElementById('certificatesCount').innerText = userStats.certificates;
        document.getElementById('aiCleanedCount').innerText = userStats.aiCleanedCount;
        
        // পয়েন্ট প্রোগ্রেস বার আপডেট
        const pointsPercentage = Math.min((points / DAILY_FREE_POINTS) * 100, 100);
        document.getElementById('pointsFill').style.width = `${pointsPercentage}%`;
        document.getElementById('pointsProgress').innerText = `${points}/${DAILY_FREE_POINTS}`;
        document.getElementById('profilePointsFill').style.width = `${pointsPercentage}%`;
        document.getElementById('profilePointsProgress').innerText = `${points}/${DAILY_FREE_POINTS}`;
        
        const statusElement = document.getElementById('premiumStatus');
        const profileStatusElement = document.getElementById('profileStatus');
        const verifiedBadge = document.getElementById('verifiedBadge');
        const profileVerifiedBadge = document.getElementById('profileVerifiedBadge');
        const certificateButton = document.getElementById('certificateButton');
        const profileVerificationMessage = document.getElementById('verificationMessageProfile');
        const verificationRequestBtn = document.getElementById('verificationRequestBtn');

        // প্রিমিয়াম স্ট্যাটাস
        if (isPremium) {
            statusElement.innerText = 'প্রিমিয়াম';
            statusElement.className = 'status-badge status-premium';
            profileStatusElement.innerText = 'প্রিমিয়াম';
            profileStatusElement.className = 'status-badge status-premium';
            document.getElementById('premiumMessage').innerText = 'আপনার প্রিমিয়াম সাবস্ক্রিপশন চালু আছে। আনলিমিটেড কপিরাইট ফ্রি করুন!';
            document.getElementById('buyPremiumBtn').classList.add('hidden');
            document.getElementById('buyPremiumBtnYearly').classList.add('hidden');
            document.getElementById('paymentVerificationForm').classList.add('hidden');
        } else {
            statusElement.innerText = 'ফ্রি ইউজার';
            statusElement.className = 'status-badge status-free';
            profileStatusElement.innerText = 'ফ্রি ইউজার';
            profileStatusElement.className = 'status-badge status-free';
            document.getElementById('premiumMessage').innerText = 'আনলিমিটেড ভিডিও কপিরাইট ফ্রি করার জন্য প্রিমিয়াম কিনুন।';
            document.getElementById('buyPremiumBtn').classList.remove('hidden');
            document.getElementById('buyPremiumBtnYearly').classList.remove('hidden');
        }
        
        // প্রিমিয়াম ট্যাব "PRO" ব্যাজ আপডেট
        document.querySelectorAll('.pro-badge').forEach(badge => {
            isPremium ? badge.classList.remove('hidden') : badge.classList.add('hidden');
        });
        
        // ভেরিফায়েড স্ট্যাটাস
        if (isVerified) {
            verifiedBadge.classList.remove('hidden');
            profileVerifiedBadge.classList.remove('hidden');
            profileVerificationMessage.innerHTML = '✨ **অভিনন্দন!** আপনার প্রোফাইল **ভেরিফাইড ক্রিয়েটর ব্যাজ** পেয়েছে।';
            verificationRequestBtn.classList.add('hidden');
        } else {
            verifiedBadge.classList.add('hidden');
            profileVerifiedBadge.classList.add('hidden');
            profileVerificationMessage.innerHTML = 'আপনার প্রোফাইল বর্তমানে **ভেরিফাইড** নয়। নিয়মিত উচ্চ মানের কপিরাইট ফ্রি ভিডিও আপলোড করলে এবং প্রিমিয়াম ইউজার হলে স্বয়ংক্রিয়ভাবে ভেরিফাইড ব্যাজ পেতে পারেন। অথবা ম্যানুয়ালি আবেদন করুন।';
            if (userStats.processedVideos >= 5) {
                 verificationRequestBtn.classList.remove('hidden');
            } else {
                 verificationRequestBtn.classList.add('hidden');
            }
        }
        
        // সার্টিফিকেট বাটন লজিক
        if (isPremium && document.getElementById('resultContainer').classList.contains('hidden') === false && document.getElementById('cleanOutput').classList.contains('hidden') === false) {
             certificateButton.classList.remove('hidden');
        } else {
             certificateButton.classList.add('hidden');
        }
    }
    
    // --- পেমেন্ট যাচাইকরণ লজিক ---
    function showPaymentVerification(type) {
        currentPaymentType = type;
        const amount = (type === 'monthly' ? '৳300' : '৳3000');
        
        document.getElementById('paymentAmount').innerHTML = `পেমেন্ট করতে হবে: <strong>${amount}</strong>`;
        document.getElementById('buyPremiumBtn').classList.add('hidden');
        document.getElementById('buyPremiumBtnYearly').classList.add('hidden');
        document.getElementById('paymentVerificationForm').classList.remove('hidden');
        document.getElementById('verificationMessage').innerText = ''; 
        document.getElementById('transactionId').value = '';
        document.getElementById('secretPin').value = '';
        
        switchTab('premium');
        showNotification('পেমেন্ট সম্পন্ন করার পর, গোপন পিন পেতে Telegram-এ (@copyrighesupportteam) যোগাযোগ করুন।', 'warning'); 
    }

    function verifyPayment() {
        const email = getLoggedInEmail();
        const trxId = document.getElementById('transactionId').value.trim();
        const pin = document.getElementById('secretPin').value.trim();
        const verificationMessage = document.getElementById('verificationMessage');
        
        verificationMessage.style.color = 'red';

        if (!trxId || !pin) {
            verificationMessage.innerText = '⚠️ ট্রানজ্যাকশন আইডি এবং গোপন পিন উভয়ই আবশ্যক।';
            return;
        }

        const isValidPinPattern = pin.startsWith('.');
        const usedPins = getUsedPins();

        if (!isValidPinPattern) {
            verificationMessage.innerText = '❌ পেমেন্ট যাচাই করা যায়নি। অনুগ্রহ করে টেলিগ্রাম সাপোর্ট টিম থেকে নেওয়া সঠিক গোপন পিনটি দিন।';
        } else if (usedPins.includes(pin)) {
            verificationMessage.innerText = '❌ এই গোপন পিনটি ইতিমধ্যেই একবার ব্যবহার করা হয়েছে। নতুন পেমেন্টের জন্য সাপোর্ট টিম থেকে নতুন পিন নিন।';
        } else {
            setPremium(email, true);
            addUsedPin(pin); 
            updateUI(email);
            
            verificationMessage.style.color = '#43a047';
            verificationMessage.innerText = '✅ পেমেন্ট সফলভাবে যাচাই হয়েছে! আপনি এখন প্রিমিয়াম ইউজার।';
            
            setTimeout(() => {
                 document.getElementById('paymentVerificationForm').classList.add('hidden');
            }, 2000);
            
            showNotification('অভিনন্দন! আপনার প্রিমিয়াম সাবস্ক্রিপশন চালু হয়েছে।');
        }
    }

    // --- ভিডিও প্রসেসিং লজিক ---
    function handleFileUpload() {
        const email = getLoggedInEmail();
        const fileInput = document.getElementById('videoFile');
        const statusElement = document.getElementById('scanStatus');
        const resultContainer = document.getElementById('resultContainer');
        const videoElement = document.getElementById('uploadedVideo');
        const agreeRules = document.getElementById('agreeRules').checked;
        const copyrightReport = document.getElementById('copyrightReport');
        const cleanOutput = document.getElementById('cleanOutput');
        const file = fileInput.files[0];
        
        // রিসেট UI
        resultContainer.classList.add('hidden');
        copyrightReport.classList.add('hidden');
        cleanOutput.classList.add('hidden');
        document.getElementById('cleanStatus').innerText = '';

        if (!file || !agreeRules) {
            statusElement.style.color = 'red';
            statusElement.innerText = !file ? '⚠️ একটি ভিডিও ফাইল নির্বাচন করুন।' : '⚠️ কপিরাইট ফ্রি করার শর্তাবলী অবশ্যই মেনে নিতে হবে।';
            showNotification(!file ? 'একটি ভিডিও ফাইল নির্বাচন করুন।' : 'শর্তাবলী অবশ্যই মেনে নিতে হবে।', 'error');
            return;
        }

        statusElement.style.color = '#ff9800';
        statusElement.innerText = '⏳ ভিডিও আপলোড ও প্রাথমিক স্ক্যান করা হচ্ছে... (AI স্ক্যানিং সিমুলেশন)...';

        if (videoURL) { URL.revokeObjectURL(videoURL); }
        videoURL = URL.createObjectURL(file);
        videoFileName = file.name; 

        videoElement.src = videoURL;
        
        videoElement.onloadedmetadata = function() {
            currentVideoDuration = videoElement.duration;
            const duration = currentVideoDuration;
            document.getElementById('videoDuration').innerText = duration.toFixed(2);

            let isAllowed = false;
            let message = '';
            let hasCopyrightFlag = Math.random() < 0.5;

            if (isPremiumUser(email)) {
                isAllowed = true;
                message = `✅ প্রিমিয়াম স্ক্যান সফল। ${duration.toFixed(2)} সেকেন্ডের ভিডিও।`;
            } else {
                const currentPoints = getPoints(email);
                const cost = COST_PER_10_SEC;
                
                if (duration <= 10.0) {
                    if (currentPoints >= cost) {
                        isAllowed = true;
                        savePoints(email, currentPoints - cost);
                        message = `✅ স্ক্যান সফল। ${duration.toFixed(2)} সেকেন্ডের ভিডিওর জন্য ${cost} পয়েন্ট খরচ হলো।`;
                    } else {
                        isAllowed = false;
                        message = `❌ স্ক্যান ব্যর্থ। ${cost} পয়েন্ট প্রয়োজন। আপনার আছে ${currentPoints} পয়েন্ট।`;
                        hasCopyrightFlag = false;
                    }
                } else {
                    isAllowed = false;
                    message = `❌ স্ক্যান ব্যর্থ। ফ্রি অ্যাকাউন্টে শুধুমাত্র ১০ সেকেন্ড পর্যন্ত ভিডিও কপিরাইট ফ্রি করা যায়। আপনার ভিডিও ${duration.toFixed(2)} সেকেন্ডের।`;
                    hasCopyrightFlag = false;
                }
            }

            updateUI(email);

            setTimeout(() => {
                if (isAllowed) {
                    const userStats = getUserStats(email);
                    updateUserStats(email, 'processedVideos', userStats.processedVideos + 1);

                    resultContainer.classList.remove('hidden');

                    if (hasCopyrightFlag) {
                        statusElement.style.color = 'red';
                        statusElement.innerText = '❌ স্ক্যান সম্পন্ন: আংশিক কপিরাইট ফ্লাগড!';
                        copyrightReport.classList.remove('hidden');
                        copyrightReport.className = 'report-section';
                        document.getElementById('reportStatus').innerText = 'Flagged';
                        
                        const randomTimestamp = (Math.random() * duration * 0.8).toFixed(1);
                        document.getElementById('reportDetails').innerHTML = `<strong>কারণ:</strong> অডিও কন্টেন্টে <strong>${randomTimestamp} সেকেন্ড</strong> পজিশনে **আংশিক মিল** পাওয়া গেছে। AI ক্লিনার ব্যবহার করে ফিক্স করা যেতে পারে।`;
                        
                        cleanOutput.classList.add('hidden');
  } else {
                        statusElement.style.color = '#43a047';
                        statusElement.innerText = message + ' কপিরাইট ফ্রি: Safe to Use.';
                        copyrightReport.classList.remove('hidden');
                        copyrightReport.className = 'report-section clean';
                        document.getElementById('reportStatus').innerText = 'Clean / Safe to Use';
                        document.getElementById('reportDetails').innerHTML = `<strong>রেজাল্ট:</strong> ভিডিওটি আমাদের সিস্টেম দ্বারা **কপিরাইট ফ্রি** হিসেবে চিহ্নিত হয়েছে।`;
                        cleanOutput.classList.remove('hidden');
                        document.getElementById('publicCheckboxContainer').classList.remove('hidden');
                        
                        updateUserStats(email, 'cleanVideos', userStats.cleanVideos + 1);
                        updateUI(email);
                    }
                    
                    switchTab('upload');
                } else {
                    statusElement.style.color = 'red';
                    statusElement.innerText = message;
                    showNotification(message, 'error');
                }
            }, 2500);
        };
        
        videoElement.onerror = function() {
            statusElement.style.color = 'red';
            statusElement.innerText = '❌ ভিডিও ফাইল লোড করতে সমস্যা হয়েছে।';
            resultContainer.classList.add('hidden');
            if(videoURL) URL.revokeObjectURL(videoURL);
            videoURL = null;
        };
    }

    // --- AI Auto Copyright Cleaner লজিক ---
    function aiAutoClean() {
        const email = getLoggedInEmail();
        const cleanStatus = document.getElementById('cleanStatus');
        const reportDetails = document.getElementById('reportDetails');
        const reportSection = document.getElementById('copyrightReport');
        const cleanOutput = document.getElementById('cleanOutput');
        const userStats = getUserStats(email);
        
        if (!isPremiumUser(email) && currentVideoDuration > 10.0) {
            showNotification('❌ ফ্রি ইউজাররা শুধুমাত্র ১০ সেকেন্ডের ভিডিও ক্লিন করতে পারবেন।', 'error');
            return;
        }

        cleanStatus.style.color = 'var(--primary)';
        cleanStatus.innerText = '⏳ AI সিস্টেম ভিডিও ক্লিন করছে... (২ সেকেন্ডের মধ্যে নতুন ভার্সন প্রস্তুত)...';
        
        setTimeout(() => {
            reportSection.className = 'report-section clean';
            document.getElementById('reportStatus').innerText = 'Cleaned by AI / Safe to Use';
            reportDetails.innerHTML = `<strong>রেজাল্ট:</strong> AI অটো ক্লিনার ব্যবহার করে ভিডিওর কপিরাইটযুক্ত অংশ **সফলভাবে ফিক্স** করা হয়েছে।`;
            document.getElementById('scanStatus').style.color = '#43a047';
            document.getElementById('scanStatus').innerText = `✅ AI ক্লিনার সফলভাবে ভিডিওটি কপিরাইট ফ্রি করেছে।`;
            cleanStatus.innerText = '';
            cleanOutput.classList.remove('hidden');
            document.getElementById('publicCheckboxContainer').classList.remove('hidden');

            updateUserStats(email, 'cleanVideos', userStats.cleanVideos + 1);
            updateUserStats(email, 'aiCleanedCount', userStats.aiCleanedCount + 1);
            updateUI(email);

            showNotification('✅ ভিডিও সফলভাবে AI দ্বারা কপিরাইট ফ্রি করা হয়েছে!', 'success');
        }, 2000);
    }

    // --- ভিডিও ডাউনলোড ---
    function downloadVideo() { 
        if (!videoURL) {
            showNotification('ডাউনলোড করার জন্য কোনো ভিডিও নেই।', 'error');
            return;
        }
        
        const email = getLoggedInEmail();
        const addToPublic = document.getElementById('addToPublicLibrary').checked;

        if (addToPublic) {
            const isClean = document.getElementById('reportStatus').innerText.includes('Clean');
            if(isClean) {
                 showNotification('ভিডিওটি পাবলিক লাইব্রেরিতে যোগ করা হয়েছে। ধন্যবাদ!', 'secondary');
                 document.getElementById('addToPublicLibrary').checked = false;
            } else {
                 showNotification('❌ শুধুমাত্র "Clean" স্ট্যাটাসের ভিডিও পাবলিক লাইব্রেরিতে যোগ করা যায়।', 'error');
            }
        }
        
        const a = document.createElement('a');
        a.href = videoURL;
        a.download = "CopyrightFree_" + videoFileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        showNotification('ভিডিও সফলভাবে ডাউনলোড হয়েছে!');
    }
    
    // --- নতুন ভিডিও এডিটর ফাংশনালিটি ---
    function initializeEditorControls() {
        // ভলিউম কন্ট্রোল
        document.getElementById('volumeControl').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('volumeValue').textContent = value + '%';
            const video = document.getElementById('editorVideoOutput');
            if (video.src) {
                video.volume = value / 100;
            }
        });

        // স্পিড কন্ট্রোল
        document.getElementById('speedControl').addEventListener('input', function() {
            const value = this.value;
            const speed = value / 100;
            document.getElementById('speedValue').textContent = speed.toFixed(1) + 'x';
            const video = document.getElementById('editorVideoOutput');
            if (video.src) {
                video.playbackRate = speed;
            }
        });

        // ব্রাইটনেস কন্ট্রোল
        document.getElementById('brightnessControl').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('brightnessValue').textContent = value + '%';
            updateVideoFilter();
        });

        // কন্ট্রাস্ট কন্ট্রোল
        document.getElementById('contrastControl').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('contrastValue').textContent = value + '%';
            updateVideoFilter();
        });

        // ট্রিম কন্ট্রোল
        document.getElementById('trimStart').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('trimStartValue').textContent = value + '%';
        });

        document.getElementById('trimEnd').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('trimEndValue').textContent = value + '%';
        });

        // ফন্ট সাইজ কন্ট্রোল
        document.getElementById('fontSizeControl').addEventListener('input', function() {
            const value = this.value;
            document.getElementById('fontSizeValue').textContent = value + 'px';
        });

        // ভিডিও ফাইল সিলেক্ট
        document.getElementById('editorVideoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const videoURL = URL.createObjectURL(file);
                const video = document.getElementById('editorVideoOutput');
                video.src = videoURL;
                video.classList.remove('hidden');
                showNotification('ভিডিও লোড হয়েছে! এখন এডিট করুন।', 'success');
            }
        });
        
        // থাম্বনেল ভিডিও ফাইল সিলেক্ট
        document.getElementById('thumbnailVideoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                showNotification('ভিডিও লোড হয়েছে! এখন থাম্বনেল জেনারেট করুন।', 'success');
            }
        });
    }

    function updateVideoFilter() {
        const video = document.getElementById('editorVideoOutput');
        const brightness = document.getElementById('brightnessControl').value;
        const contrast = document.getElementById('contrastControl').value;
        const filter = document.getElementById('filterSelect').value;
        
        let filterValue = `brightness(${brightness}%) contrast(${contrast}%)`;
        
        if (filter === 'grayscale') filterValue += ' grayscale(100%)';
        else if (filter === 'sepia') filterValue += ' sepia(100%)';
        else if (filter === 'vintage') filterValue += ' sepia(50%) contrast(120%)';
        else if (filter === 'cool') filterValue += ' hue-rotate(180deg)';
        else if (filter === 'warm') filterValue += ' hue-rotate(-30deg) saturate(150%)';
        
        video.style.filter = filterValue;
    }

    function applyFilter() {
        updateVideoFilter();
    }

    function updateWatermark() {
        // ওয়াটারমার্ক ইম্প্লিমেন্টেশন (সিমুলেশন)
        showNotification('ওয়াটারমার্ক প্রয়োগ করা হয়েছে!', 'success');
    }

    function playPauseVideo() {
        const video = document.getElementById('editorVideoOutput');
        if (video.paused) {
            video.play();
        } else {
            video.pause();
        }
    }

    function resetVideo() {
        const video = document.getElementById('editorVideoOutput');
        video.currentTime = 0;
        video.style.filter = 'none';
        document.getElementById('brightnessControl').value = 100;
        document.getElementById('contrastControl').value = 100;
        document.getElementById('volumeControl').value = 100;
        document.getElementById('speedControl').value = 100;
        document.getElementById('filterSelect').value = 'none';
        
        document.getElementById('brightnessValue').textContent = '100%';
        document.getElementById('contrastValue').textContent = '100%';
        document.getElementById('volumeValue').textContent = '100%';
        document.getElementById('speedValue').textContent = '1.0x';
        
        showNotification('সব এডিট রিসেট করা হয়েছে!', 'warning');
    }

    function applyAllEdits() {
        showNotification('🎉 সব এডিট সফলভাবে প্রয়োগ করা হয়েছে!', 'success');
    }

    function downloadEditedVideo() {
        const email = getLoggedInEmail();
        if (!isPremiumUser(email)) {
            showNotification('❌ এডিটেড ভিডিও ডাউনলোড শুধুমাত্র প্রিমিয়াম ইউজারদের জন্য।', 'error');
            return;
        }
        
        const video = document.getElementById('editorVideoOutput');
        if (!video.src) {
            showNotification('⚠️ প্রথমে একটি ভিডিও লোড করুন।', 'error');
            return;
        }
        
        showNotification('✅ এডিটেড ভিডিও ডাউনলোড শুরু হচ্ছে...', 'success');
        // আসলে ডাউনলোড ইম্প্লিমেন্ট করতে MediaRecorder API ব্যবহার করতে হবে
    }
    
    function saveToGallery(type) {
        if (type === 'video') {
            const video = document.getElementById('editorVideoOutput');
            if (!video.src) {
                showNotification('⚠️ প্রথমে একটি ভিডিও লোড করুন।', 'error');
                return;
            }
            
            const item = {
                name: 'এডিটেড ভিডিও',
                type: 'video',
                url: video.src,
                description: 'AI-পাওয়ারড এডিটেড ভিডিও'
            };
            
            saveToGallery('video', item);
        }
    }

    // --- অ্যাডভান্সড এডিটিং ফিচার সিমুলেশন ---
    function simulateAIBackgroundRemoval() {
        showNotification('⏳ AI ব্যাকগ্রাউন্ড রিমুভাল প্রসেস চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ ব্যাকগ্রাউন্ড সফলভাবে রিমুভ হয়েছে!', 'success');
        }, 2000);
    }
    
    function simulateFaceEnhancement() {
        showNotification('⏳ ফেস এনহ্যান্সমেন্ট প্রসেস চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ ফেস সফলভাবে এনহ্যান্স হয়েছে!', 'success');
        }, 2000);
    }
    
    function simulateAutoSubtitle() {
        showNotification('⏳ অটো সাবটাইটেল জেনারেশন চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ সাবটাইটেল সফলভাবে জেনারেট হয়েছে!', 'success');
        }, 2000);
    }
    
    function simulateStabilization() {
        showNotification('⏳ ভিডিও স্ট্যাবিলাইজেশন চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ ভিডিও সফলভাবে স্ট্যাবিলাইজ হয়েছে!', 'success');
        }, 2000);
    }
    
    function simulateNoiseReduction() {
        showNotification('⏳ নয়েজ রিডাকশন চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ নয়েজ সফলভাবে রিমুভ হয়েছে!', 'success');
        }, 2000);
    }
    
    function simulateSmartCropping() {
        showNotification('⏳ স্মার্ট ক্রপিং চলছে...', 'warning');
        setTimeout(() => {
            showNotification('✅ ভিডিও সফলভাবে ক্রপ হয়েছে!', 'success');
        }, 2000);
    }

    // --- থাম্বনেল জেনারেটর ---
    function generateThumbnails() {
        const description = document.getElementById('thumbnailDescription').value.trim();
        const style = document.getElementById('thumbnailStyle').value;
        const text = document.getElementById('thumbnailText').value.trim();
        const fontSize = document.getElementById('fontSizeControl').value;
        
        if (!description) {
            showNotification('⚠️ থাম্বনেলের জন্য একটি ডিসক্রিপশন লিখুন।', 'error');
            return;
        }
        
        const statusElement = document.getElementById('thumbnailStatus');
        const resultsContainer = document.getElementById('thumbnailResults');
        
        statusElement.style.color = 'var(--primary)';
        statusElement.innerText = '⏳ AI থাম্বনেল জেনারেট করছে...';
        resultsContainer.classList.add('hidden');
        
        setTimeout(() => {
            statusElement.style.color = '#43a047';
            statusElement.innerText = '✅ থাম্বনেল সফলভাবে জেনারেট হয়েছে!';
            
            // থাম্বনেল জেনারেট করা
            const thumbnails = [];
            for (let i = 0; i < 3; i++) {
                const thumbnail = generateThumbnailImage(description, style, text, fontSize, i);
                thumbnails.push(thumbnail);
            }
            
            // থাম্বনেল ডিসপ্লে করা
            displayThumbnails(thumbnails);
            resultsContainer.classList.remove('hidden');
            
            showNotification('থাম্বনেল সফলভাবে জেনারেট হয়েছে!', 'success');
        }, 3000);
    }
    
    function generateThumbnailImage(description, style, text, fontSize, index) {
        const canvas = document.getElementById('thumbnailCanvas');
        const ctx = canvas.getContext('2d');
        
        // ক্যানভাস সাইজ সেট করা
        canvas.width = 400;
        canvas.height = 225; // 16:9 রেশিও
        
        // ব্যাকগ্রাউন্ড কালার স্টাইল অনুযায়ী
        let bgColor, textColor;
        switch(style) {
            case 'modern':
                bgColor = '#4361ee';
                textColor = '#ffffff';
                break;
            case 'vintage':
                bgColor = '#8b4513';
                textColor = '#f5deb3';
                break;
            case 'minimal':
                bgColor = '#ffffff';
                textColor = '#333333';
                break;
            case 'bold':
                bgColor = '#e63946';
                textColor = '#ffffff';
                break;
            case 'dark':
                bgColor = '#222222';
                textColor = '#ffffff';
                break;
            default:
                bgColor = '#4361ee';
                textColor = '#ffffff';
        }
        
        // ব্যাকগ্রাউন্ড ফিল
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // ডিজাইন এলিমেন্টস যোগ করা
        if (style === 'modern') {
            // গ্রেডিয়েন্ট ওভারলে
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, 'rgba(67, 97, 238, 0.7)');
            gradient.addColorStop(1, 'rgba(114, 9, 183, 0.7)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        } else if (style === 'vintage') {
            // টেক্সচার ওভারলে
            ctx.fillStyle = 'rgba(139, 69, 19, 0.3)';
            for (let i = 0; i < 50; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = Math.random() * 3 + 1;
                ctx.fillRect(x, y, size, size);
            }
        }
        
        // টেক্সট যোগ করা
        if (text) {
            ctx.fillStyle = textColor;
            ctx.font = `bold ${fontSize}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText(text, canvas.width / 2, canvas.height / 2);
        }
        
        // ডিসক্রিপশন যোগ করা
        ctx.fillStyle = textColor;
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(description, canvas.width / 2, canvas.height - 30);
        
        // ওয়াটারমার্ক যোগ করা
        ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
        ctx.font = '12px Arial';
        ctx.textAlign = 'right';
        ctx.fillText('CopyrightFree.video', canvas.width - 10, canvas.height - 10);
        
        return canvas.toDataURL('image/png');
    }
    
    function displayThumbnails(thumbnails) {
        const resultsContainer = document.getElementById('thumbnailResults');
        let html = '';
        
        thumbnails.forEach((thumbnail, index) => {
            html += `
                <div class="thumbnail-item">
                    <img src="${thumbnail}" class="thumbnail-image" alt="থাম্বনেল ${index + 1}">
                    <div class="thumbnail-overlay">
                        থাম্বনেল ${index + 1}
                    </div>
                    <div class="thumbnail-actions">
                        <button onclick="downloadThumbnail('${thumbnail}', ${index})"><i class="fas fa-download"></i></button>
                        <button onclick="saveThumbnailToGallery('${thumbnail}', ${index})"><i class="fas fa-save"></i></button>
                    </div>
                </div>
            `;
        });
        
        resultsContainer.innerHTML = html;
    }
    
    function downloadThumbnail(thumbnailData, index) {
        const link = document.createElement('a');
        link.download = `Thumbnail_${index + 1}.png`;
        link.href = thumbnailData;
        link.click();
        showNotification(`থাম্বনেল ${index + 1} ডাউনলোড হয়েছে!`, 'success');
    }
    
    function saveThumbnailToGallery(thumbnailData, index) {
        const item = {
            name: `থাম্বনেল ${index + 1}`,
            type: 'thumbnail',
            url: thumbnailData,
            description: 'AI-জেনারেটেড থাম্বনেল'
        };
        
        saveToGallery('thumbnail', item);
    }

    // --- গ্যালারি ফাংশনালিটি ---
    function renderGallery() {
        const gallery = getGallery();
        const emptyMessage = document.getElementById('emptyGalleryMessage');
        
        // ভিডিও গ্যালারি
        const videosGallery = document.getElementById('videosGallery');
        let videosHtml = '';
        
        if (gallery.videos.length > 0) {
            gallery.videos.forEach(video => {
                videosHtml += `
                    <div class="gallery-item">
                        <video class="gallery-image" src="${video.url}" controls></video>
                        <div class="gallery-info">
                            <div class="gallery-title">${video.name}</div>
                            <div class="gallery-meta">${new Date(video.createdAt).toLocaleDateString('bn-BD')}</div>
                            <div class="gallery-actions">
                                <button onclick="downloadGalleryItem('${video.url}', '${video.name}.mp4')"><i class="fas fa-download"></i></button>
                                <button onclick="deleteGalleryItem('video', '${video.id}')" style="background: var(--danger);"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        videosGallery.innerHTML = videosHtml;
        
        // থাম্বনেল গ্যালারি
        const thumbnailsGallery = document.getElementById('thumbnailsGallery');
        let thumbnailsHtml = '';
        
        if (gallery.thumbnails.length > 0) {
            gallery.thumbnails.forEach(thumbnail => {
                thumbnailsHtml += `
                    <div class="gallery-item">
                        <img class="gallery-image" src="${thumbnail.url}" alt="${thumbnail.name}">
                        <div class="gallery-info">
                            <div class="gallery-title">${thumbnail.name}</div>
                            <div class="gallery-meta">${new Date(thumbnail.createdAt).toLocaleDateString('bn-BD')}</div>
                            <div class="gallery-actions">
                                <button onclick="downloadGalleryItem('${thumbnail.url}', '${thumbnail.name}.png')"><i class="fas fa-download"></i></button>
                                <button onclick="deleteGalleryItem('thumbnail', '${thumbnail.id}')" style="background: var(--danger);"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        thumbnailsGallery.innerHTML = thumbnailsHtml;
        
        // সার্টিফিকেট গ্যালারি
        const certificatesGallery = document.getElementById('certificatesGallery');
        let certificatesHtml = '';
        
        if (gallery.certificates.length > 0) {
            gallery.certificates.forEach(certificate => {
                certificatesHtml += `
                    <div class="gallery-item">
                        <img class="gallery-image" src="${certificate.url}" alt="${certificate.name}">
                        <div class="gallery-info">
                            <div class="gallery-title">${certificate.name}</div>
                            <div class="gallery-meta">${new Date(certificate.createdAt).toLocaleDateString('bn-BD')}</div>
                            <div class="gallery-actions">
                                <button onclick="downloadGalleryItem('${certificate.url}', '${certificate.name}.png')"><i class="fas fa-download"></i></button>
                                <button onclick="deleteGalleryItem('certificate', '${certificate.id}')" style="background: var(--danger);"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        certificatesGallery.innerHTML = certificatesHtml;
        
        // এম্পটি মেসেজ শো/হাইড
        const totalItems = gallery.videos.length + gallery.thumbnails.length + gallery.certificates.length;
        if (totalItems > 0) {
            emptyMessage.classList.add('hidden');
        } else {
            emptyMessage.classList.remove('hidden');
        }
    }
    
    function downloadGalleryItem(url, filename) {
        const link = document.createElement('a');
        link.download = filename;
        link.href = url;
        link.click();
        showNotification(`${filename} ডাউনলোড হয়েছে!`, 'success');
    }
    
    function deleteGalleryItem(type, id) {
        const email = getLoggedInEmail();
        const gallery = JSON.parse(localStorage.getItem(LS_KEY_GALLERY) || '{}');
        
        if (gallery[email]) {
            if (type === 'video') {
                gallery[email].videos = gallery[email].videos.filter(item => item.id !== id);
            } else if (type === 'thumbnail') {
                gallery[email].thumbnails = gallery[email].thumbnails.filter(item => item.id !== id);
            } else if (type === 'certificate') {
                gallery[email].certificates = gallery[email].certificates.filter(item => item.id !== id);
            }
            
            localStorage.setItem(LS_KEY_GALLERY, JSON.stringify(gallery));
            renderGallery();
            showNotification('আইটেম ডিলিট হয়েছে!', 'success');
        }
    }

    // --- উন্নত সার্টিফিকেট জেনারেটর ---
    function generateCertificate() {
        const email = getLoggedInEmail();
        if (!isPremiumUser(email)) {
            showNotification('❌ সার্টিফিকেট ডাউনলোড করতে হলে আপনাকে অবশ্যই প্রিমিয়াম ইউজার হতে হবে।', 'error');
            return;
        }
        if (!document.getElementById('reportStatus').innerText.includes('Clean')) {
            showNotification('❌ সার্টিফিকেট শুধুমাত্র কপিরাইট ফ্রি ("Clean") ভিডিওর জন্য প্রযোজ্য।', 'error');
            return;
        }
        
        const canvas = document.getElementById('certificateCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 1200;
        canvas.height = 800;

        // Background with gradient
        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
        gradient.addColorStop(0, '#f8f9fa');
        gradient.addColorStop(1, '#e9ecef');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Border
        ctx.strokeStyle = '#004aad';
        ctx.lineWidth = 15;
        ctx.strokeRect(25, 25, canvas.width - 50, canvas.height - 50);
        
        ctx.strokeStyle = '#d4af37';
        ctx.lineWidth = 8;
        ctx.strokeRect(40, 40, canvas.width - 80, canvas.height - 80);

        // Header
        ctx.fillStyle = '#004aad';
        ctx.font = 'bold 48px "Times New Roman", serif';
        ctx.textAlign = 'center';
        ctx.fillText('CERTIFICATE OF COPYRIGHT CLEARANCE', canvas.width / 2, 120);

        // Decorative line
        ctx.strokeStyle = '#d4af37';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(200, 140);
        ctx.lineTo(canvas.width - 200, 140);
        ctx.stroke();

        // Subtitle
        ctx.fillStyle = '#666';
        ctx.font = 'italic 24px "Georgia", serif';
        ctx.fillText('This is to certify that', canvas.width / 2, 190);

        // Video Name
        ctx.fillStyle = '#222';
        ctx.font = 'bold 32px "Helvetica", sans-serif';
        ctx.fillText(`"${videoFileName}"`, canvas.width / 2, 250);

        // User Info
        ctx.font = '22px "Helvetica", sans-serif';
        ctx.fillText('Uploaded and Processed by:', canvas.width / 2, 310);
        ctx.fillStyle = '#004aad';
        ctx.font = 'bold 26px "Helvetica", sans-serif';
        ctx.fillText(getLoggedInEmail(), canvas.width / 2, 350);

        // Body Text
        ctx.fillStyle = '#444';
        ctx.font = '20px "Georgia", serif';
        ctx.fillText('has been successfully analyzed and cleared by our advanced', canvas.width / 2, 420);
        ctx.fillText('AI-powered copyright detection system on', canvas.width / 2, 460);

        // Date
        const currentDate = new Date().toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });
        ctx.font = 'bold 22px "Georgia", serif';
        ctx.fillText(currentDate, canvas.width / 2, 500);

        // Status
        ctx.fillStyle = '#43a047';
        ctx.font = 'bold 28px "Helvetica", sans-serif';
        ctx.fillText('STATUS: CLEARED FOR USE', canvas.width / 2, 560);

        // License ID
        const licenseID = `CFV-${new Date().getFullYear()}-${Math.floor(Math.random() * 90000) + 10000}`;
        ctx.fillStyle = '#666';
        ctx.font = '18px "Courier New", monospace';
        ctx.fillText(`License ID: ${licenseID}`, canvas.width / 2, 610);

        // Official Seal
        ctx.beginPath();
        ctx.arc(150, 650, 60, 0, 2 * Math.PI);
        ctx.fillStyle = '#e63946';
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 3;
        ctx.stroke();
        
        ctx.fillStyle = 'white';
        ctx.font = 'bold 16px "Helvetica", sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('OFFICIAL', 150, 640);
        ctx.font = 'bold 14px "Helvetica", sans-serif';
        ctx.fillText('SEAL', 150, 660);
        ctx.font = 'bold 10px "Helvetica", sans-serif';
        ctx.fillText('CFV.AI', 150, 675);

        // Signature
        ctx.fillStyle = '#333';
        ctx.font = 'italic 20px "Georgia", serif';
        ctx.textAlign = 'right';
        ctx.fillText('Authorized Signature', canvas.width - 150, 730);
        
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(canvas.width - 300, 740);
        ctx.lineTo(canvas.width - 50, 740);
        ctx.stroke();

        ctx.font = '16px "Georgia", serif';
        ctx.fillText('CopyrightFree.video AI System', canvas.width - 150, 770);

        // Download
        const certificateData = canvas.toDataURL('image/png');
        const link = document.createElement('a');
        link.download = `CopyrightFree_Certificate_${videoFileName.split('.')[0]}.png`;
        link.href = certificateData;
        link.click();
        
        // গ্যালারিতে সেভ করা
        const item = {
            name: `সার্টিফিকেট - ${videoFileName.split('.')[0]}`,
            type: 'certificate',
            url: certificateData,
            description: 'কপিরাইট ফ্রি সার্টিফিকেট'
        };
        
        saveToGallery('certificate', item);
        
        const userStats = getUserStats(email);
        updateUserStats(email, 'certificates', userStats.certificates + 1);
        updateUI(email);
        
        showNotification('✅ লাইসেন্স সার্টিফিকেট সফলভাবে ডাউনলোড হয়েছে!', 'success');
    }

    // --- বাকি ফাংশনগুলো একই রাখা হয়েছে ---
    function checkVerificationEligibility(email) {
        const userStats = getUserStats(email);
        if (isPremiumUser(email) && userStats.cleanVideos >= 10 && !isVerifiedCreator(email)) {
            setVerified(email, true);
            updateUI(email);
            showNotification('🎉 স্বয়ংক্রিয় ভেরিফিকেশন সফল! আপনি এখন "ভেরিফাইড ক্রিয়েটর"।', 'secondary');
        }
    }

    function requestVerification() {
        const email = getLoggedInEmail();
        document.getElementById('verificationRequestBtn').classList.add('hidden');
        showNotification(`✅ ${email} এর জন্য ভেরিফিকেশন আবেদন জমা পড়েছে।`, 'success');
        setTimeout(() => {
             setVerified(email, true);
             updateUI(email);
             showNotification('🎉 ম্যানুয়াল ভেরিফিকেশন সফল! আপনি এখন "ভেরিফাইড ক্রিয়েটর"।', 'secondary');
        }, 5000);
    }
    
    // --- ইনিশিয়ালাইজেশন ---
    document.addEventListener('DOMContentLoaded', checkAuthStatus);
    window.addEventListener('beforeunload', () => { if (videoURL) { URL.revokeObjectURL(videoURL); } });
</script>

</body>
</html>
